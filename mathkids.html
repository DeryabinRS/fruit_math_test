<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ —Å —Ñ—Ä—É–∫—Ç–∞–º–∏ | 5-6 –ª–µ—Ç</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Marker Felt', cursive;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
            padding: 10px;
        }

        .app-container {
            background-color: white;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 100%;
            max-width: 650px;
            min-height: 88vh;
            overflow: hidden;
            position: relative;
        }

        /* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
        .decoration {
            position: absolute;
            opacity: 0.25;
            z-index: 0;
        }
        .star { color: #ffd700; font-size: 40px; }
        .circle { color: #ff6b6b; font-size: 30px; }
        .square { color: #4ecdc4; font-size: 35px; }

        /* –•–µ–¥–µ—Ä */
        .header {
            background: linear-gradient(to right, #ff9a9e, #fad0c4);
            padding: 14px;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .header h1 {
            font-size: 1.9rem;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            margin-bottom: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        .header h1 span { font-size: 2.5rem; }

        .stars-container {
            display: flex;
            justify-content: center;
            gap: 3px;
            margin-top: 12px;
        }
        .star-icon {
            font-size: 24px;
            color: #ffd700;
            transition: transform 0.3s;
        }
        .star-icon.filled {
            transform: scale(1.2);
            animation: twinkle 1s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç */
        .content {
            padding: 8px;
            text-align: center;
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .title {
            font-size: 2rem;
            color: #667eea;
            margin-bottom: 5px;
            min-height: 40px;
        }

        .subtitle {
            font-size: 1.3rem;
            color: #555;
            margin-bottom: 10px;
            font-weight: bold;
        }

        /* –£—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ñ—Ä—É–∫—Ç–∞–º–∏ */
        .equation-container {
            width: 100%;
            background: #f9f7ff;
            border-radius: 25px;
            padding: 8px;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .equation {
            font-size: 2.8rem;
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            min-height: 70px;
        }
        .equation .number {
            color: #667eea;
            min-width: 60px;
            text-align: center;
        }
        .equation .operator {
            color: #ff6b6b;
            font-size: 3.2rem;
            min-width: 50px;
            text-align: center;
        }
        .equation .minus {
            color: #4ecdc4;
            font-size: 3.2rem;
        }
        .equation .equals {
            color: #4ecdc4;
            min-width: 40px;
            text-align: center;
        }
        .equation .question {
            color: #ff9a9e;
            min-width: 60px;
            text-align: center;
        }

        /* –§—Ä—É–∫—Ç—ã */
        .fruits-container {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 25px;
            margin: 8px 0;
            min-height: 100px;
            flex-wrap: wrap;
        }
        .fruits-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        .fruits-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            max-width: 200px;
            min-height: 30px;
        }
        .fruit {
            font-size: 28px;
            transition: transform 0.3s, opacity 0.3s;
            user-select: none;
        }
        .fruit.removed {
            opacity: 0.2;
            transform: scale(0.6) translateY(15px);
        }
        .fruit-count {
            font-size: 1.1rem;
            color: #666;
            font-weight: bold;
            background: rgba(255, 255, 255, 0.7);
            padding: 3px 10px;
            border-radius: 15px;
            min-width: 40px;
        }

        /* –ö–Ω–æ–ø–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ */
        .answer-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            margin: 8px 0;
            width: 100%;
        }
        .answer-btn {
            padding: 18px 5px;
            font-size: 1.7rem;
            width: calc(33% - 10px);
            min-width: 80px;
            border: none;
            border-radius: 20px;
            background: linear-gradient(to right, #667eea, #764ba2);
            color: white;
            cursor: pointer;
            transition: all 0.25s;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        .answer-btn:hover {
            transform: scale(1.08);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
        }
        .answer-btn.correct {
            background: linear-gradient(to right, #4facfe, #00f2fe);
            animation: pulse 0.6s;
            transform: scale(1.1);
        }
        .answer-btn.wrong {
            background: linear-gradient(to right, #ff6b6b, #ee5a24);
            animation: shake 0.5s;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }

        /* –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å */
        .feedback {
            padding: 18px;
            border-radius: 20px;
            font-size: 1.45rem;
            font-weight: bold;
            display: none;
            line-height: 1.3;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        .feedback.success {
            background: linear-gradient(to right, #00c853, #64dd17);
            color: white;
            display: block;
            animation: bounceIn 0.6s;
        }
        .feedback.error {
            background: linear-gradient(to right, #ff1744, #ff5252);
            color: white;
            display: block;
            animation: bounceIn 0.6s;
        }

        @keyframes bounceIn {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.08); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* –ö–Ω–æ–ø–∫–∞ "–î–∞–ª—å—à–µ" */
        .next-btn {
            background: linear-gradient(to right, #00c853, #64dd17);
            color: white;
            border: none;
            padding: 18px 40px;
            font-size: 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px 0;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 6px 15px rgba(0, 150, 0, 0.4);
            width: 90%;
            max-width: 300px;
        }
        .next-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 9px 20px rgba(0, 150, 0, 0.5);
        }
        .next-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* –ü—Ä–æ–≥—Ä–µ—Å—Å */
        .progress {
            font-size: 1.25rem;
            color: #555;
            font-weight: bold;
            background: rgba(255, 255, 255, 0.6);
            padding: 8px 20px;
            border-radius: 20px;
            display: inline-block;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —Ñ—Ä—É–∫—Ç–æ–≤ */
        @keyframes fruitDrop {
            0% { transform: translateY(-30px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        .fruit.animate {
            animation: fruitDrop 0.4s forwards;
        }

        /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.6rem;
            }
            .header h1 span { font-size: 2.1rem; }
            .equation {
                font-size: 2.3rem;
                gap: 8px;
            }
            .equation .operator, .equation .minus {
                font-size: 2.6rem;
            }
            .fruit {
                font-size: 24px;
            }
            .answer-btn {
                font-size: 1.5rem;
                padding: 16px 5px;
                width: calc(50% - 10px);
            }
            .fruits-container {
                gap: 15px;
            }
            .next-btn {
                font-size: 1.4rem;
                padding: 16px 30px;
            }
            .feedback {
                font-size: 1.3rem;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –î–µ–∫–æ—Ä–∞—Ü–∏–∏ -->
        <div class="decoration star" style="top: 20px; left: 30px;">‚òÖ</div>
        <div class="decoration circle" style="top: 100px; right: 40px;">‚óè</div>
        <div class="decoration square" style="bottom: 100px; left: 40px;">‚ñ†</div>
        <div class="decoration star" style="bottom: 40px; right: 50px;">‚òÖ</div>

        <!-- –•–µ–¥–µ—Ä -->
        <div class="header">
            <h1><span>üçé</span> –§—Ä—É–∫—Ç–æ–≤–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞</h1>
            <div class="stars-container" id="stars">
                <div class="star-icon">‚òÜ</div>
                <div class="star-icon">‚òÜ</div>
                <div class="star-icon">‚òÜ</div>
                <div class="star-icon">‚òÜ</div>
                <div class="star-icon">‚òÜ</div>
            </div>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="content">
            <h3 class="title" id="task-type">‚ûï –°–ª–æ–∂–µ–Ω–∏–µ</h3>
            <p class="subtitle" id="task-instruction">–°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ —Ñ—Ä—É–∫—Ç–æ–≤?</p>
            
            <div class="equation-container">
                <div class="equation" id="math-task">
                    <span class="number">5</span>
                    <span class="operator">+</span>
                    <span class="number">3</span>
                    <span class="equals">=</span>
                    <span class="question">?</span>
                </div>
                
                <div class="fruits-container" id="fruits-container">
                    <div class="fruits-group">
                        <div class="fruits-row" id="fruits-left"></div>
                        <div class="fruit-count" id="count-left">5 —è–±–ª–æ–∫</div>
                    </div>
                    <div class="fruits-group" id="operator-group" style="align-self: center; font-size: 2.5rem; margin: 0 10px;">
                        +
                    </div>
                    <div class="fruits-group">
                        <div class="fruits-row" id="fruits-right"></div>
                        <div class="fruit-count" id="count-right">3 —è–±–ª–æ–∫–∞</div>
                    </div>
                </div>
            </div>
            
            <div class="answer-buttons" id="answer-buttons">
                <!-- –ö–Ω–æ–ø–∫–∏ –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>

            <div class="feedback" id="feedback"></div>
            
            <button class="next-btn" id="next-btn" onclick="nextTask()" disabled>–î–∞–ª—å—à–µ ‚û°Ô∏è</button>
            <div class="progress" id="progress">–ó–∞–¥–∞–Ω–∏–µ 1 –∏–∑ 10</div>
        </div>
    </div>

    <script>
        // ========== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
        let currentTask = 1;
        let correctAnswers = 0;
        let currentProblem = {
            a: 5,
            b: 3,
            operator: '+',
            answer: 8,
            type: 'addition',
            fruit: 'üçé' // –û–î–ò–ù —Ñ—Ä—É–∫—Ç –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞
        };
        let totalTasks = 20;
        let fruitsAnimationRunning = false;

        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        document.addEventListener('DOMContentLoaded', () => {
            generateTask();
        });

        // ========== –ì–ï–ù–ï–†–ê–¶–ò–Ø –ó–ê–î–ê–ù–ò–Ø ==========
        function generateTask() {
            const taskType = document.getElementById('task-type');
            const taskInstruction = document.getElementById('task-instruction');
            const mathTask = document.getElementById('math-task');
            const operatorGroup = document.getElementById('operator-group');
            
            // –ß–µ—Ä–µ–¥—É–µ–º —Å–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ
            const isAddition = currentTask % 2 === 1;
            
            let a, b, answer, operator, type, fruit;
            
            // –í—ã–±–∏—Ä–∞–µ–º –û–î–ò–ù —Ñ—Ä—É–∫—Ç –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞
            const fruits = ['üçé', 'üçå', 'üçä', 'üçá', 'üçí', 'üçì', 'ü•ù', 'üçç', 'üçë', 'üçâ'];
            const fruitIndex = (currentTask - 1) % fruits.length;
            fruit = fruits[fruitIndex];
            
            if (isAddition) {
                // –°–ª–æ–∂–µ–Ω–∏–µ: 2-8 + 1-5, —Ä–µ–∑—É–ª—å—Ç–∞—Ç <= 10
                a = Math.floor(Math.random() * 7) + 2; // 2-8
                b = Math.floor(Math.random() * Math.min(6, 11 - a)) + 1; // 1-5, —Å—É–º–º–∞ <= 10
                answer = a + b;
                operator = '+';
                type = 'addition';
                taskType.textContent = '‚ûï –°–ª–æ–∂–µ–Ω–∏–µ';
                taskType.style.color = '#4CAF50';
                taskInstruction.textContent = '–°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ —Ñ—Ä—É–∫—Ç–æ–≤?';
                operatorGroup.textContent = '+';
                operatorGroup.className = '';
                operatorGroup.style.color = '#ff6b6b';
            } else {
                // –í—ã—á–∏—Ç–∞–Ω–∏–µ: —É–º–µ–Ω—å—à–∞–µ–º–æ–µ 5-10, –≤—ã—á–∏—Ç–∞–µ–º–æ–µ 1-5
                a = Math.floor(Math.random() * 6) + 5; // 5-10
                b = Math.floor(Math.random() * Math.min(5, a - 1)) + 1; // 1-5, –º–µ–Ω—å—à–µ a
                answer = a - b;
                operator = '-';
                type = 'subtraction';
                taskType.textContent = '‚ûñ –í—ã—á–∏—Ç–∞–Ω–∏–µ';
                taskType.style.color = '#ff6b6b';
                taskInstruction.textContent = '–°–∫–æ–ª—å–∫–æ —Ñ—Ä—É–∫—Ç–æ–≤ –æ—Å—Ç–∞–ª–æ—Å—å?';
                operatorGroup.textContent = '-';
                operatorGroup.className = 'minus';
                operatorGroup.style.color = '#4ecdc4';
            }
            
            currentProblem = { a, b, operator, answer, type, fruit };
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø—Ä–∏–º–µ—Ä
            mathTask.innerHTML = `
                <span class="number">${a}</span>
                <span class="operator ${operator === '-' ? 'minus' : ''}">${operator}</span>
                <span class="number">${b}</span>
                <span class="equals">=</span>
                <span class="question">?</span>
            `;
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ñ—Ä—É–∫—Ç—ã (–û–î–ò–ù–ê–ö–û–í–´–ï –¥–ª—è –æ–±–æ–∏—Ö —á–∏—Å–µ–ª)
            renderFruits();
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤
            generateAnswerButtons(answer);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            document.getElementById('progress').textContent = `–ó–∞–¥–∞–Ω–∏–µ ${currentTask} –∏–∑ ${totalTasks}`;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–∏–¥–±–µ–∫
            document.getElementById('feedback').className = 'feedback';
        }

        // ========== –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –§–†–£–ö–¢–û–í ==========
        function renderFruits() {
            const fruitsLeft = document.getElementById('fruits-left');
            const fruitsRight = document.getElementById('fruits-right');
            const countLeft = document.getElementById('count-left');
            const countRight = document.getElementById('count-right');
            
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ñ—Ä—É–∫—Ç—ã
            fruitsLeft.innerHTML = '';
            fruitsRight.innerHTML = '';
            
            const { a, b, type, fruit } = currentProblem;
            
            // –ù–∞–∑–≤–∞–Ω–∏—è —Ñ—Ä—É–∫—Ç–æ–≤ –¥–ª—è –ø–æ–¥–ø–∏—Å–µ–π
            const fruitNames = {
                'üçé': '—è–±–ª–æ–∫', 'üçå': '–±–∞–Ω–∞–Ω–æ–≤', 'üçä': '–∞–ø–µ–ª—å—Å–∏–Ω–æ–≤', 
                'üçá': '–≤–∏–Ω–æ–≥—Ä–∞–¥–∏–Ω', 'üçí': '–≤–∏—à–µ–Ω', 'üçì': '–∫–ª—É–±–Ω–∏–∫–∏',
                'ü•ù': '–∫–∏–≤–∏', 'üçç': '–∞–Ω–∞–Ω–∞—Å–æ–≤', 'üçë': '–ø–µ—Ä—Å–∏–∫–æ–≤', 'üçâ': '–∞—Ä–±—É–∑–æ–≤'
            };
            
            const fruitName = fruitNames[fruit] || '—Ñ—Ä—É–∫—Ç–æ–≤';
            
            // –†–∏—Å—É–µ–º —Ñ—Ä—É–∫—Ç—ã —Å–ª–µ–≤–∞ (–≤—Å–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ)
            for (let i = 0; i < a; i++) {
                const fruitEl = document.createElement('div');
                fruitEl.className = 'fruit';
                fruitEl.textContent = fruit;
                fruitsLeft.appendChild(fruitEl);
            }
            
            // –†–∏—Å—É–µ–º —Ñ—Ä—É–∫—Ç—ã —Å–ø—Ä–∞–≤–∞ (—Ç–µ –∂–µ —Å–∞–º—ã–µ —Ñ—Ä—É–∫—Ç—ã!)
            for (let i = 0; i < b; i++) {
                const fruitEl = document.createElement('div');
                fruitEl.className = 'fruit';
                fruitEl.textContent = fruit;
                fruitsRight.appendChild(fruitEl);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥–ø–∏—Å–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞–º–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞
            function getPlural(count, wordForms) {
                // wordForms: [1 —à—Ç, 2-4 —à—Ç, 5+ —à—Ç]
                const cases = [2, 0, 1, 1, 1, 2];
                return wordForms[(count % 100 > 4 && count % 100 < 20) ? 2 : cases[Math.min(count % 10, 5)]];
            }
            
            // –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—ã –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ñ—Ä—É–∫—Ç–æ–≤
            const pluralForms = {
                '—è–±–ª–æ–∫': ['—è–±–ª–æ–∫–æ', '—è–±–ª–æ–∫–∞', '—è–±–ª–æ–∫'],
                '–±–∞–Ω–∞–Ω–æ–≤': ['–±–∞–Ω–∞–Ω', '–±–∞–Ω–∞–Ω–∞', '–±–∞–Ω–∞–Ω–æ–≤'],
                '–∞–ø–µ–ª—å—Å–∏–Ω–æ–≤': ['–∞–ø–µ–ª—å—Å–∏–Ω', '–∞–ø–µ–ª—å—Å–∏–Ω–∞', '–∞–ø–µ–ª—å—Å–∏–Ω–æ–≤'],
                '–≤–∏–Ω–æ–≥—Ä–∞–¥–∏–Ω': ['–≤–∏–Ω–æ–≥—Ä–∞–¥–∏–Ω–∞', '–≤–∏–Ω–æ–≥—Ä–∞–¥–∏–Ω—ã', '–≤–∏–Ω–æ–≥—Ä–∞–¥–∏–Ω'],
                '–≤–∏—à–µ–Ω': ['–≤–∏—à–Ω—è', '–≤–∏—à–Ω–∏', '–≤–∏—à–µ–Ω'],
                '–∫–ª—É–±–Ω–∏–∫–∏': ['–∫–ª—É–±–Ω–∏–∫–∞', '–∫–ª—É–±–Ω–∏–∫–∏', '–∫–ª—É–±–Ω–∏–∫–∏'],
                '–∫–∏–≤–∏': ['–∫–∏–≤–∏', '–∫–∏–≤–∏', '–∫–∏–≤–∏'],
                '–∞–Ω–∞–Ω–∞—Å–æ–≤': ['–∞–Ω–∞–Ω–∞—Å', '–∞–Ω–∞–Ω–∞—Å–∞', '–∞–Ω–∞–Ω–∞—Å–æ–≤'],
                '–ø–µ—Ä—Å–∏–∫–æ–≤': ['–ø–µ—Ä—Å–∏–∫', '–ø–µ—Ä—Å–∏–∫–∞', '–ø–µ—Ä—Å–∏–∫–æ–≤'],
                '–∞—Ä–±—É–∑–æ–≤': ['–∞—Ä–±—É–∑', '–∞—Ä–±—É–∑–∞', '–∞—Ä–±—É–∑–æ–≤']
            };
            
            const baseForm = fruitName;
            const forms = pluralForms[baseForm] || [baseForm, baseForm, baseForm];
            
            countLeft.textContent = `${a} ${getPlural(a, forms)}`;
            countRight.textContent = `${b} ${getPlural(b, forms)}`;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —Ñ—Ä—É–∫—Ç–æ–≤
            setTimeout(() => {
                document.querySelectorAll('.fruit').forEach((fruitEl, index) => {
                    setTimeout(() => {
                        fruitEl.classList.add('animate');
                    }, 100 + index * 50);
                });
            }, 100);
        }

        // ========== –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–ù–û–ü–û–ö –û–¢–í–ï–¢–û–í ==========
        function generateAnswerButtons(correctAnswer) {
            const answerButtons = document.getElementById('answer-buttons');
            answerButtons.innerHTML = '';
            
            // –°–æ–∑–¥–∞—ë–º –º–∞—Å—Å–∏–≤ –æ—Ç–≤–µ—Ç–æ–≤: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π + 3 –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
            let wrongAnswers = [];
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 3 –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 1-10
            while (wrongAnswers.length < 3) {
                let wrong = Math.floor(Math.random() * 10) + 1;
                
                // –î–ª—è –≤—ã—á–∏—Ç–∞–Ω–∏—è –∏—Å–∫–ª—é—á–∞–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∏ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞
                if (currentProblem.operator === '-') {
                    if (wrong >= currentProblem.a || wrong < 0) continue;
                }
                
                if (wrong !== correctAnswer && !wrongAnswers.includes(wrong)) {
                    wrongAnswers.push(wrong);
                }
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
            let allAnswers = [...wrongAnswers, correctAnswer];
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º
            allAnswers.sort(() => Math.random() - 0.5);
            
            // –°–æ–∑–¥–∞—ë–º –∫–Ω–æ–ø–∫–∏
            allAnswers.forEach(answer => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                btn.textContent = answer;
                btn.onclick = () => checkAnswer(answer);
                answerButtons.appendChild(btn);
            });
        }

        // ========== –ü–†–û–í–ï–†–ö–ê –û–¢–í–ï–¢–ê ==========
        function checkAnswer(selectedAnswer) {
            if (fruitsAnimationRunning) return;
            
            const feedback = document.getElementById('feedback');
            const nextBtn = document.getElementById('next-btn');
            const answerButtons = document.querySelectorAll('.answer-btn');
            
            if (selectedAnswer === currentProblem.answer) {
                // –ü–†–ê–í–ò–õ–¨–ù–´–ô –û–¢–í–ï–¢
                feedback.innerHTML = getRandomSuccessMessage();
                feedback.className = 'feedback success';
                correctAnswers++;
                
                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É
                answerButtons.forEach(btn => {
                    if (parseInt(btn.textContent) === selectedAnswer) {
                        btn.classList.add('correct');
                    }
                    // –ë–ª–æ–∫–∏—Ä—É–µ–º –í–°–ï –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
                    btn.disabled = true;
                });
                
                // –î–ª—è –≤—ã—á–∏—Ç–∞–Ω–∏—è ‚Äî –∞–Ω–∏–º–∞—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è —Ñ—Ä—É–∫—Ç–æ–≤
                if (currentProblem.type === 'subtraction') {
                    animateSubtraction();
                } else {
                    // –î–ª—è —Å–ª–æ–∂–µ–Ω–∏—è ‚Äî —Å—Ä–∞–∑—É –¥–æ–±–∞–≤–ª—è–µ–º –∑–≤–µ–∑–¥—É –∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º "–î–∞–ª—å—à–µ"
                    setTimeout(() => {
                        addStar();
                        nextBtn.disabled = false;
                    }, 500);
                }
            } else {
                // –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ô –û–¢–í–ï–¢
                feedback.innerHTML = getRandomErrorMessage();
                feedback.className = 'feedback error';
                
                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –¢–û–õ–¨–ö–û –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É –∏ –±–ª–æ–∫–∏—Ä—É–µ–º –µ—ë
                answerButtons.forEach(btn => {
                    const answerValue = parseInt(btn.textContent);
                    if (answerValue === selectedAnswer) {
                        btn.classList.add('wrong');
                        btn.disabled = true; // –±–ª–æ–∫–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —ç—Ç—É –∫–Ω–æ–ø–∫—É
                    }
                });
                
                // –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏!
                // –ö–Ω–æ–ø–∫–∞ "–î–∞–ª—å—à–µ" –æ—Å—Ç–∞—ë—Ç—Å—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–π
            }
        }

        // ========== –ê–ù–ò–ú–ê–¶–ò–Ø –í–´–ß–ò–¢–ê–ù–ò–Ø ==========
        function animateSubtraction() {
            fruitsAnimationRunning = true;
            const fruitsRight = document.querySelectorAll('#fruits-right .fruit');
            
            // –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ "—É–¥–∞–ª—è–µ–º" —Ñ—Ä—É–∫—Ç—ã —Å–ø—Ä–∞–≤–∞
            fruitsRight.forEach((fruit, index) => {
                setTimeout(() => {
                    fruit.classList.add('removed');
                }, index * 200);
            });
            
            // –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                fruitsAnimationRunning = false;
                addStar();
                document.getElementById('next-btn').disabled = false;
            }, fruitsRight.length * 200 + 500);
        }

        // ========== –°–õ–ï–î–£–Æ–©–ï–ï –ó–ê–î–ê–ù–ò–ï ==========
        function nextTask() {
            currentTask++;
            
            if (currentTask > totalTasks) {
                showResults();
                return;
            }
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª—å—à–µ"
            document.getElementById('next-btn').disabled = true;
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ
            generateTask();
        }

        // ========== –ü–û–ö–ê–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í ==========
        function showResults() {
            const feedback = document.getElementById('feedback');
            const nextBtn = document.getElementById('next-btn');
            const answerButtons = document.getElementById('answer-buttons');
            const fruitsContainer = document.getElementById('fruits-container');
            
            // –°–∫—Ä—ã–≤–∞–µ–º —Ñ—Ä—É–∫—Ç—ã –∏ –∫–Ω–æ–ø–∫–∏
            fruitsContainer.style.display = 'none';
            answerButtons.innerHTML = '';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            let resultMessage = `üéâ –¢—ã —Ä–µ—à–∏–ª ${totalTasks} –ø—Ä–∏–º–µ—Ä–æ–≤!<br><br>`;
            resultMessage += `‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: <span style="font-size: 1.8rem; color: #ffd700">${correctAnswers}</span> –∏–∑ ${totalTasks}<br><br>`;
            
            // –û—Ü–µ–Ω–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            if (correctAnswers === totalTasks) {
                resultMessage += 'üåüüåüüåü<br>–¢–´ –ù–ê–°–¢–û–Ø–©–ò–ô –ú–ê–¢–ï–ú–ê–¢–ò–ö!<br>–í–°–Å –ü–†–ê–í–ò–õ–¨–ù–û!';
                feedback.style.background = 'linear-gradient(to right, #ffd700, #ffa500)';
            } else if (correctAnswers >= 8) {
                resultMessage += 'üåüüåü<br>–û–¢–õ–ò–ß–ù–û!<br>–¢—ã –ø–æ—á—Ç–∏ –≤—Å—ë —Ä–µ—à–∏–ª –ø—Ä–∞–≤–∏–ª—å–Ω–æ!';
                feedback.style.background = 'linear-gradient(to right, #4caf50, #8bc34a)';
            } else if (correctAnswers >= 6) {
                resultMessage += 'üåü<br>–•–û–†–û–®–û!<br>–ü—Ä–æ–¥–æ–ª–∂–∞–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è!';
                feedback.style.background = 'linear-gradient(to right, #8bc34a, #cddc39)';
            } else {
                resultMessage += 'üí™<br>–¢–´ –ú–û–õ–û–î–ï–¶, –ß–¢–û –ü–†–û–ë–û–í–ê–õ!<br>–¢—Ä–µ–Ω–∏—Ä—É–π—Å—è –µ—â—ë ‚Äî —É —Ç–µ–±—è –≤—Å—ë –ø–æ–ª—É—á–∏—Ç—Å—è!';
                feedback.style.background = 'linear-gradient(to right, #ff9800, #ffc107)';
            }
            
            feedback.innerHTML = resultMessage;
            feedback.className = 'feedback success';
            
            // –ú–µ–Ω—è–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª—å—à–µ" –Ω–∞ "–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ"
            nextBtn.textContent = '–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ üîÑ';
            nextBtn.style.background = 'linear-gradient(to right, #2196F3, #21CBF3)';
            nextBtn.onclick = resetGame;
        }

        // ========== –°–ë–†–û–° –ò–ì–†–´ ==========
        function resetGame() {
            currentTask = 1;
            correctAnswers = 0;
            fruitsAnimationRunning = false;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ—Ä—É–∫—Ç—ã
            document.getElementById('fruits-container').style.display = 'flex';
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–≤—ë–∑–¥—ã
            document.querySelectorAll('.star-icon').forEach(star => {
                star.textContent = '‚òÜ';
                star.classList.remove('filled');
            });
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
            const nextBtn = document.getElementById('next-btn');
            nextBtn.textContent = '–î–∞–ª—å—à–µ ‚û°Ô∏è';
            nextBtn.style.background = 'linear-gradient(to right, #00c853, #64dd17)';
            nextBtn.onclick = nextTask;
            nextBtn.disabled = true;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–∏–¥–±–µ–∫
            document.getElementById('feedback').className = 'feedback';
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ
            generateTask();
        }

        // ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
        function addStar() {
            const stars = document.getElementById('stars');
            const emptyStars = Array.from(stars.querySelectorAll('.star-icon')).filter(star => star.textContent === '‚òÜ');
            
            if (emptyStars.length > 0) {
                const star = emptyStars[0];
                star.textContent = '‚òÖ';
                star.classList.add('filled');
            }
        }

        function getRandomSuccessMessage() {
            const messages = [
                '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!<br>–ú–æ–ª–æ–¥–µ—Ü!',
                '‚úÖ –û—Ç–ª–∏—á–Ω–æ!<br>–¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å!',
                '‚úÖ –í–µ—Ä–Ω–æ!<br>–¢—ã —É–º–Ω–∏—Ü–∞!',
                '‚úÖ –ó–¥–æ—Ä–æ–≤–æ!<br>–ü—Ä–æ–¥–æ–ª–∂–∞–π!',
                '‚úÖ –¢–æ—á–Ω–æ!<br>–¢—ã –º–∞—Ç–µ–º–∞—Ç–∏–∫!',
                '‚úÖ –£—Ä–∞!<br>–ü—Ä–∞–≤–∏–ª—å–Ω–æ!',
                '‚úÖ –ú–æ–ª–æ–¥—á–∏–Ω–∞!<br>–í–µ—Ä–Ω–æ!'
            ];
            return messages[Math.floor(Math.random() * messages.length)];
        }

        function getRandomErrorMessage() {
            const messages = [
                '‚ùå –ü–æ—á—Ç–∏!<br>–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë!',
                '‚ùå –ù–µ —Å–æ–≤—Å–µ–º...<br>–ü–æ–¥—É–º–∞–π!',
                '‚ùå –û—à–∏–±–æ—á–∫–∞!<br>–ù–æ —Ç—ã —Å–º–æ–∂–µ—à—å!',
                '‚ùå –ù–µ—Ç,<br>–Ω–æ –Ω–µ —Ä–∞—Å—Å—Ç—Ä–∞–∏–≤–∞–π—Å—è!',
                '‚ùå –ü–æ—á—Ç–∏ –ø–æ–ª—É—á–∏–ª–æ—Å—å!<br>–ï—â—ë —Ä–∞–∑–æ–∫!',
                '‚ùå –ù–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ,<br>–Ω–æ —Ç—ã —Å—Ç–∞—Ä–∞–µ—à—å—Å—è!',
                '‚ùå –û–π!<br>–î–∞–≤–∞–π —Å–Ω–æ–≤–∞!'
            ];
            return messages[Math.floor(Math.random() * messages.length)];
        }
    </script>
</body>
</html>